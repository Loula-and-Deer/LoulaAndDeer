<style>
#price-preview::after{
  content: " per letter";
}
</style>

<div id="product" class="{{ product.handle }}" itemscope itemtype="http://schema.org/Product">
  <meta itemprop="url" content="{{ shop.url }}{{ product.url }}" />
  <meta itemprop="image" content="{{ product.featured_image.src | product_img_url: 'grande' }}" />
 
  <div class="row clearfix">
    
    <!-- Begin breadcrumb -->
    <div class="span12">
      <div class="breadcrumb clearfix" itemscope itemtype="http://schema.org/BreadcrumbList">
        <span itemscope itemtype="http://data-vocabulary.org/Breadcrumb"><a href="{{ shop.url }}" title="{{ shop.name | escape }}" itemprop="url"><span itemprop="title">Home</span></a></span> 
        <span class="arrow-space">&#62;</span>
        <span itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
          {% if collection %}
            <a href="{{ collection.url }}" title="{{ collection.title | escape }}" itemprop="url">
              <span itemprop="title">{{ collection.title }}</span>
            </a>
         
          {% else %}
            <a href="/collections/all" title="All Products" itemprop="url">
              <span itemprop="title">Products</span>
            </a>
          {% endif %}
        </span>
        <span class="arrow-space">&#62;</span>
        <strong>{{ product.title }}</strong>
      </div>
    </div>
    <!-- End breadcrumb -->
    <!-- Begin product photos -->
    <div class="{% if product.images.size == 1 or settings.thumbnails_position == 'below' %}span5{% else %}span5{% endif %}">
      
      {% assign featured_image = product.selected_or_first_available_variant.featured_image | default: product.featured_image %}
      <!-- Begin featured image -->
      <div class="image featured">
        {% if settings.enable_product_image_zoom %}
        <img src="{{ featured_image | img_url: '1024x1024' }}" alt="{{ featured_image.alt | escape }}" />
        {% else %}
        <a href="{{ featured_image | img_url: 'master' }}" class="fancy" id="placeholder">
          <img src="{{ featured_image | img_url: '1024x1024' }}" alt="{{ featured_image.alt | escape }}" />
        </a>
        {% endif %}
      </div>
      <!-- End product image -->
      
      {% if product.images.size > 1 and settings.thumbnails_position == 'below' %}
      <!-- Begin thumbnails -->
      <div class="thumbs clearfix" style="margin-left:-15px;">
        {% for image in product.images %}
        <div class="image span1{% cycle 'last-in-row': '', '', ' last-in-row' %}">
          <a href="{{ image | img_url: '1024x1024' }}">
            <img src="{{ image | img_url: 'large' }}" alt="{{ image.alt | escape }}" />
          </a>
        </div>
        {% endfor %}
      </div>
      <!-- End thumbnails -->
      <style>
      .thumbs .image { margin: 15px 0 }
      .thumbs .image { padding: 0 15px }
      .thumbs .last-in-row { padding-right: 0 }
      </style>
      {% endif %}
      
    </div>
    <!-- End product photos -->
    
    {% if product.images.size > 1 and settings.thumbnails_position == 'right' %}
    <!-- Begin thumbnails -->
    <div class="span1">
      <div class="thumbs clearfix">
        {% for image in product.images %}
        <div class="image">
          <a href="{{ image | product_img_url: '1024x1024' }}">
            <img src="{{ image | product_img_url: 'compact' }}" alt="{{ image.alt | escape }}" />
          </a>
        </div>
        {% endfor %}
      </div>
    </div>
    <!-- End thumbnails -->
    {% endif %}
    
    
    <!-- Begin description -->
    <div class="span5">
      <div>
        <h1 class="title" itemprop="name">{{ product.title }}</h1>
      </div>
      <div class="purchase" itemprop="offers" itemscope itemtype="http://schema.org/Offer" style="border-bottom: 3px solid {{  settings.shop_bg_color }}; height: 40px;">
        <meta itemprop="priceCurrency" content="{{ shop.currency }}" />
        {% if product.available %}
        <link itemprop="availability" href="http://schema.org/InStock" />
        {% else %}
        <link itemprop="availability" href="http://schema.org/OutOfStock" />
        {% endif %}
        <link itemprop="itemCondition" href="http://schema.org/NewCondition">
        {% assign variant = product.selected_or_first_available_variant %}

        <h3 class="price fl" id="price-preview" style="color: #a1a1a1">
          <span id="act-price">{{ variant.price | money }} </span>{% if variant.price < variant.compare_at_price %} <del>{{ variant.compare_at_price | money }}</del>{% endif %}
                <h3 class="title fr" style="color: #a1a1a1">{{ product.vendor }}</h3>
          <span style="display: none" itemprop="price">{{ variant.price | money_without_currency }}</span>{% if variant.price < variant.compare_at_price %} <del>{{ variant.compare_at_price | money_without_currency }}</del>{% endif %}
         
        </h3>
      </div>
      
      {% assign hide_default_title = false %}
      {% if product.variants.size == 1 and product.variants.first.title contains 'Default' %}
        {% assign hide_default_title = true %}
      {% endif %}
            
      <form id="add-item-form" class="variants clearfix">

        <!-- Begin product options -->
        <div class="product-options">
                {% include 'product-customizer' %}
          <div class="select clearfix choice"{% if hide_default_title %} style="display:none"{% endif %}>
          <label for="product-select">Style</label>
            <select id="product-select" name="id" style="display:none">
              {% for variant in product.variants %}
              <option {% if variant == product.selected_or_first_available_variant %} selected="selected" {% endif %} value="{{ variant.id }}">{{ variant.title }} - {{ variant.price | money }}</option>
              {% endfor %}
            </select>
          </div>
          
          <div class="selector-wrapper choice">
            <input  style="display:none; padding-left: 5px;" id="quantity" type="number" name="quantity" value="1"  min="1" max="9" class="tc item-quantity" />
          </div>
          
          <div>

        	<h4 class="price" style="display:inline;">Total</h4>
        	<h4 class="price" id="price-total" style="display:inline;"></h4>
          </div>
          
          <div class="purchase-section{% if product.variants.size > 1 %} multiple{% endif %} choice" style="width: 100%; clear: both; margin: 0;">
            <div class="purchase">
              <input type="submit" id="add-to-cart" class="btn" name="add" value="Add to cart" />
            </div>
          </div>
        
      <!-- End product options -->
      </form>
      <div class="description" style="clear: both;">
        {{ product.description }}
      </div>
      
      {% if settings.show_social %}
      <!-- Begin social buttons -->
      <div class="social">
        {% include 'like' %}
      </div>
      <!-- End social buttons -->
      {% endif %}

      <p style="float: left;"><a href="http://loulaanddeer.co.uk/pages/returns-policy">Returns Policy</a></p>
      <p style="float: left;">&nbsp; | &nbsp;</p>
      <p style="float: left;"><a href="http://loulaanddeer.co.uk/pages/delivery">Shipping</a></p>
    </div>
    <!-- End description -->
   
  </div>
  
  <!-- Begin related product -->
  {% if settings.show_related_products %}
    {% include 'related-products' %}
  {% endif %}
  
</div>

{% assign backboard_id = 25905254665 %}
<script>
  (function($) {
    $(function() {
        $('[name="properties[Child\'s Name]"]').attr({
            "maxlength": "9"
        });

        $('[name="properties[Child\'s Name]"]').keyup(function() {
            updatePricePreview();
        });

        $('[name="properties[Choose a Board]"]').on('change', function() {
            updatePricePreview();
        });

        $("#price-preview").text($("#price-preview").text() + " per letter");

        $(".purchase-section").css({
            "width": '100%',
            "margin": "0",
            "clear": "both"
        });

        function addToCart() {
          var quan = $('[name="properties[Child\'s Name]"]').val().length;

          $.post('/cart/add.js', {
            quantity: quan,
            id: {{variant.id}},
          });
          var backboard = $('[name="properties[Choose a Board]"]').val();

            if (backboard != "No Board") {
              $.post('/cart/add.js', {
              quantity: 1,
              id: {{backboard_id }},
            });
            }
        }

        jQuery("#add-item-form").submit(function(e) {
            var self = this;
            e.preventDefault();
            addToCart();
            location.reload();
            return false;
        });

        function calcPrice() {
            var name = $('[name="properties[Child\'s Name]"]').val();
            var backboard = $('[name="properties[Choose a Board]"]').val();
            var cost = 0.00;

            if (backboard == "No Board") {
                return cost = name.length * {{variant.price}};
            } else {
                return cost = (name.length * {{variant.price}}) + 550;
            }
        }

        function updatePricePreview() {
            check = $('[name="properties[Child\'s Name]"]');
            check.val(check.val().replace(/[^a-zA-z]|`*/g, ''));
            $('#price-total').text("Â£" + (calcPrice() / 100).toFixed(2));
        }
    });
  })(jQuery); 
</script>